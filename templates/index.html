{% extends "base.html" %}
{% block content %}
<h2 class="mb-4">Latest Plates</h2>
<div class="row g-4">
  {% for plate in plates %}
    <div class="col-md-4 col-lg-3">
      <div class="card h-100">
        {% if plate.photo %}
          <img src="{{ url_for('static', filename='uploads/' ~ plate.photo) }}" class="card-img-top" alt="Photo of {{ plate.plate }}">
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="card-title mb-1">{{ plate.plate }}</h5>
          <span class="badge bg-secondary mb-2">{{ plate.category }}</span>
          <p class="card-text"><strong>Restaurant:</strong> {{ plate.restaurant }}</p>
          <p class="card-text" style="flex-grow:1;">{{ plate.comment }}</p>
          {% if plate.rating %}
            <div class="mb-2">
              <span class="text-warning">
                {% for i in range(plate.rating) %}&#9733;{% endfor %}
                {% for i in range(5-plate.rating) %}&#9734;{% endfor %}
              </span>
            </div>
          {% endif %}
          {% if session.get('user_id') %}
            <form method="post" action="{{ url_for('favorite', plate_id=plate.id) }}">
              <button type="submit" class="btn btn-success btn-sm mt-auto">Save to My Next Plate</button>
            </form>
          {% endif %}
        </div>
        <div class="card-footer text-muted text-center small">
          {{ plate.city or '' }} {{ plate.state or '' }}<br>
          Posted {{ plate.created_at.strftime('%Y-%m-%d') if plate.created_at else '' }}
        </div>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}